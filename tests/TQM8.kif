; TQM8.kif 
; GDPR tests with modals

(instance LawyerSmith Human)
(attribute LawyerSmith Lawyer)

(instance PII Attribute)
(instance SomePII Proposition)
(property SomePII PII)
(containsInformation ACMEMarketingDoc SomePII)

(instance MsJones Human)
(employs ACME MsJones)
(instance ACMEMarketingDoc Text)

(knows LawyerSmith
   (=>
     (and
       (property ?I PII)
       (containsInformation ?DOC ?I)
       (employs ACME ?H)
       (instance ?DOC Text))
     (modalAttribute
       (exists (?DIS)
         (and
           (agent ?DIS ?H)
           (patient ?DIS ?DOC)
           (instance ?DIS Disseminating)))
       Prohibition)))

(knows ?A
   (=>
     (and
       (=> ?FA ?FC)
       ?FA)
     ?FC))

(=>
   (knows ?A
     (modalAttribute ?F Prohibition))
   (knows ?A (not ?F)))

; query
(knows LawyerSmith
   (exists (?DIS)
     (and
       (agent ?DIS ?H)
       (patient ?DIS ?DOC)
       (instance ?DIS Disseminating))))
       
